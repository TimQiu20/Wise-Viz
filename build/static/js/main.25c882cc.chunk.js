(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{223:function(e,t,a){e.exports=a(392)},228:function(e,t,a){},240:function(e,t,a){},28:function(e,t,a){e.exports=a.p+"static/media/default_profile_picture.b790abbf.png"},390:function(e,t,a){},391:function(e,t,a){},392:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(23),o=a.n(r),i=(a(228),a(12)),l=a(9),c=a(14),u=a(13),m=a(15),d=a(62),h=a.n(d),p=a(63),f=a.n(p),g=a(61),E=a.n(g),b=a(149),w=a.n(b),C=a(150),v=a.n(C),P=a(152),k=a.n(P),O=a(151),j=a.n(O),y=a(22),S=a(2),N=a(28),U=a.n(N);a(240);function I(e){return s.a.createElement(S.m,Object.assign({direction:"up"},e))}var D=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={open:!1},a.handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(S.b,{open:this.state.open,TransitionComponent:I,onClose:this.handleClose},s.a.createElement(S.e,null,"Help/About"),s.a.createElement(S.d,null,s.a.createElement("b",null,"Help: "),s.a.createElement("br",null)," ",s.a.createElement("br",null),s.a.createElement("b",null,"Each user needs to log in before posting his idea. New users need to sign up first and then go to log in."),s.a.createElement("br",null)," ",s.a.createElement("br",null),s.a.createElement("b",null,"After updating your profile picture, you can see your new profile picture by relogining the account."),s.a.createElement("br",null)," ",s.a.createElement("br",null),s.a.createElement("b",null,"About: "),s.a.createElement("br",null)," ",s.a.createElement("br",null),s.a.createElement("b",null,"Wise-Vizs uses forums, as a place for users to socially interact.")),s.a.createElement(S.c,null,s.a.createElement(S.a,{onClick:this.handleClose,color:"primary"},"Ok"))))}}]),t}(s.a.Component),T=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleDrawer=function(){return a.setState({open:!a.state.open})},a.closeDrawer=function(){return a.setState({open:!1})},a.state={open:!1},a.helpChild=s.a.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"ChangeView",value:function(e){Object(y.navigate)(e)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"root"},s.a.createElement(h.a,{position:"static"},s.a.createElement(f.a,null,s.a.createElement(E.a,{className:"menuButton",color:"inherit","aria-label":"Menu",onClick:this.toggleDrawer},s.a.createElement(w.a,null)),s.a.createElement("div",{className:"layout"},s.a.createElement("div",{className:"titleAndHome"},s.a.createElement("h2",{className:"title"},"Wise-Vizs"),s.a.createElement(S.a,{color:"inherit",onClick:function(){e.ChangeView("/"),e.props.updateClickedUsername("")}},"Home")),s.a.createElement("div",{className:"accountFormat"},null!==this.props.user&&s.a.createElement("img",{className:"roundedCircleArticleImgNavBar",src:"http://res.cloudinary.com/cjyjimmy520/image/upload/w_1000,c_fill,ar_1:1,g_auto,r_max,bo_5px_solid_red,b_rgb:262c35/"+this.props.user.url+"/profile_picture/"+this.props.user.email+"/"+this.props.user.email+".jpg",alt:"user",onError:function(e){e.target.onerror=null,e.target.src=U.a}}),s.a.createElement(S.a,{color:"inherit",className:"account",onClick:function(){null==e.props.user?e.ChangeView("/login"):e.ChangeView("/user")}},"Account"))))),s.a.createElement(S.g,{open:this.state.open,onClose:this.closeDrawer},s.a.createElement("div",{tabIndex:0,role:"button",onClick:this.closeDrawer},s.a.createElement("div",{width:"250"},s.a.createElement(S.j,{button:!0,key:"Home",onClick:function(){e.ChangeView("/"),e.props.updateClickedUsername("")}},s.a.createElement(S.k,null,s.a.createElement(v.a,null)),s.a.createElement(S.l,{primary:"Home"})),s.a.createElement(S.j,{button:!0,key:"Account",onClick:function(){null==e.props.user?e.ChangeView("/login"):e.ChangeView("/user")}},s.a.createElement(S.k,null,s.a.createElement(j.a,null)),s.a.createElement(S.l,{primary:"Account"})),s.a.createElement(S.f,null),s.a.createElement(S.j,{button:!0,key:"Help",onClick:function(){return e.helpChild.current.handleOpen()}},s.a.createElement(S.k,null,s.a.createElement(k.a,null)),s.a.createElement(S.l,{primary:"Help"}))))),s.a.createElement(D,{ref:this.helpChild}))}}]),t}(s.a.Component),x=a(25),A=Object(x.createMuiTheme)({palette:{primary:{main:"#3949ab"},secondary:{main:"#7986cb"}},typography:{h4:{fontWeight:500,fontSize:30},h5:{fontSize:25}}}),_=a(153),q=a.n(_),R=a(3);a(98);function V(e){return s.a.createElement(S.m,Object.assign({direction:"up"},e))}var B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.props.handleCreatePostClose(),a.setState({open:!1})},a.state={open:!1,errInfo:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(S.b,{open:this.state.open,TransitionComponent:V},s.a.createElement(S.d,null,s.a.createElement("br",null),s.a.createElement("b",null,"Post successfully ^_^!")),s.a.createElement(S.c,null,s.a.createElement(S.a,{onClick:this.handleClose,color:"primary",type:"Button"},"Ok"))))}}]),t}(s.a.Component),H=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleEventChange=function(e){return function(t){var n=a.state;n[e]=t.target.value,a.setState({newUserData:n,error:!1})}},a.state={postTitle:"",postContent:"",username:"",error:!1},a.checkPostAndPost=a.checkPostAndPost.bind(Object(R.a)(Object(R.a)(a))),a.postSucceedChild=s.a.createRef(),a.getUsername=a.getUsername.bind(Object(R.a)(Object(R.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"getUsername",value:function(){var e=this,t={email:this.props.user.email},a=new Request("api/user-info/get-username",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)});fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({username:t[0].userName})})}},{key:"componentDidMount",value:function(){this.getUsername()}},{key:"checkPostAndPost",value:function(){if(""===this.state.postTitle)this.setState({error:!0});else{var e=new Date,t={postID:Math.random().toString(36).substr(2,9),title:this.state.postTitle,content:this.state.postContent,postTime:e.toISOString().slice(0,19).replace("T"," "),email:this.props.user.email,username:this.state.username,url:this.props.user.url},a=new Request("api/post-info/post",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)});fetch(a).then(function(e){e.json().then(function(e){})}),this.postSucceedChild.current.handleOpen()}}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"content"},s.a.createElement(B,{ref:this.postSucceedChild,handleCreatePostClose:this.props.handleCreatePostClose.bind(this)}),s.a.createElement("form",{className:"grid"},s.a.createElement("fieldset",{className:"fieldset"},s.a.createElement("legend",null,"New Post"),s.a.createElement("h2",null,"Post Title:"),s.a.createElement(S.n,{required:!0,error:this.state.error,label:"Post Title",variant:"outlined",value:this.state.postTitle,className:"postTitleText",onChange:this.handleEventChange("postTitle")}),s.a.createElement("br",null),s.a.createElement("h2",null,"Content:"),s.a.createElement("textarea",{name:"message",className:"textarea",rows:"10",cols:"30",wrap:"soft",value:this.state.postContent,onChange:this.handleEventChange("postContent")}),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement(S.a,{variant:"contained",color:"secondary",className:"postButtons",onClick:function(){return e.props.handleCreatePostClose()}},"Cancel"),s.a.createElement(S.a,{variant:"contained",color:"primary",className:"postButtons",onClick:this.checkPostAndPost},"Post"))))}}]),t}(s.a.Component),L=a(396);a(47);function M(e){return s.a.createElement(S.m,Object.assign({direction:"up"},e))}var F=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleEventChange=function(e){return function(e){var t=e.target.value;a.setState({pageNum:t})}},a.handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){var e=Number(a.state.pageNum);e<1||e>a.props.totalPages?a.setState({pageNum:"",error:!0}):(a.props.choosePage(e),a.setState({open:!1,error:!1,pageNum:""}))},a.handleCloseForCancel=function(){a.setState({open:!1,error:!1,pageNum:""})},a.state={open:!1,pageNum:"",error:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(S.b,{open:this.state.open,TransitionComponent:M,onClose:this.handleClose},s.a.createElement(S.d,{className:"changePageD"},s.a.createElement("br",null),s.a.createElement("b",null,"Skip to page "),s.a.createElement(S.n,{required:!0,error:this.state.error,label:"(Page Number)",margin:"dense",className:"pageNumTextField",type:"number",value:this.state.pageNum,onChange:this.handleEventChange("pageNum"),InputLabelProps:{shrink:!0}}),this.state.error&&s.a.createElement("p",{className:"error"},"Error: Please enter a number between 1 and ",this.props.totalPages,".")),s.a.createElement(S.c,null,s.a.createElement(S.a,{onClick:this.handleClose,color:"primary"},"Ok"),s.a.createElement(S.a,{onClick:this.handleCloseForCancel,color:"secondary"},"Cancel"))))}}]),t}(s.a.Component),z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={posts:[],numOfPosts:0,currentPage:1,numOfPages:0,currentShownPosts:[],buttons:[]},a.getPosts=a.getPosts.bind(Object(R.a)(Object(R.a)(a))),a.getPageButtons=a.getPageButtons.bind(Object(R.a)(Object(R.a)(a))),a.updateCurrentPosts=a.updateCurrentPosts.bind(Object(R.a)(Object(R.a)(a))),a.updataPosts=a.updataPosts.bind(Object(R.a)(Object(R.a)(a))),a.changePageChild=s.a.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"ChangeView",value:function(e){Object(y.navigate)(e)}}]),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getPosts()}},{key:"getPosts",value:function(){var e=this,t={username:this.props.clickedUsername},a="";a=""===this.props.clickedUsername?new Request("api/post-info/get"):new Request("api/post-info/get-click-user-post",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)}),fetch(a).then(function(e){return e.json()}).then(function(t){return e.setState({posts:t})}).then(function(){var t=e.state.posts.length,a=Math.ceil(t/3);0===a&&(a=1);for(var n=[],s=3*(e.state.currentPage-1);s<3*e.state.currentPage&&s<t;s++){var r=e.state.posts[s];n[s]=r}e.setState({numOfPosts:t,numOfPages:a,currentShownPosts:n}),e.getPageButtons()})}},{key:"updataPosts",value:function(e){for(var t=[],a=3*(e-1);a<3*e&&a<this.state.numOfPosts;a++){var n=this.state.posts[a];t[a]=n}this.setState({currentShownPosts:t}),this.getPageButtons(e)}},{key:"updateCurrentPosts",value:function(e){this.setState({currentPage:e}),this.updataPosts(e)}},{key:"getPageButtons",value:function(e){null==e&&(e=1);var t=this.state.numOfPages,a=e,n=[];n[0]=1;for(var s=1,r=a-2>1?a-2:2;r<=a+2&&r<=t;r++)n[s-1]+1!==r&&(n[s]="...",s++),n[s]=r,s++;n[s-1]!==t&&(n[s-1]!==t-1?(n[s]="...",n[s+1]=t):n[s]=t),this.setState({buttons:n})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("form",{className:"grid",method:"post",action:""},s.a.createElement("br",null),s.a.createElement(F,{ref:this.changePageChild,choosePage:this.updateCurrentPosts,totalPages:this.state.numOfPages}),this.state.currentShownPosts.map(function(t,a){return s.a.createElement("article",{className:"postArticle",key:a},s.a.createElement("fieldset",{className:"postFieldset"},s.a.createElement("div",{className:"userInfoDiv"},s.a.createElement("img",{className:"roundedCircleArticleImg",src:t.url?"http://res.cloudinary.com/cjyjimmy520/image/upload/w_1000,c_fill,ar_1:1,g_auto,r_max,bo_5px_solid_red,b_rgb:262c35/"+t.url+"/profile_picture/"+t.userEmail+"/"+t.userEmail+".jpg":U.a,alt:"user",onError:function(e){e.target.onerror=null,e.target.src=U.a}}),s.a.createElement("div",{className:"postContentLayout"},s.a.createElement("div",{className:"postProfile"},s.a.createElement(L.a,{className:"userInfoPUsername",onClick:function(){e.props.updateClickedUsername(t.username)}},t.username),s.a.createElement("p",{className:"userInfoP"},"| ",t.postTime)),s.a.createElement("hr",{className:"hr",width:"100%",color:"#7986cb",size:3}),s.a.createElement("h2",{className:"h2ForPostTitle"},s.a.createElement(L.a,{className:"postTitle",onClick:function(){e.props.updateClickedPost(t),e.ChangeView("/postContent")}},t.title.length>50?t.title.substring(0,30)+"...":t.title)),s.a.createElement("p",{className:"postContent"},t.content.length>200?t.content.substring(0,350)+"...":t.content)))),s.a.createElement("br",null))})),s.a.createElement("div",{className:"pageButtons"},this.state.buttons.map(function(t,a){return t===e.state.currentPage?s.a.createElement(L.a,{className:"currentPageButton",key:a,num:t,variant:"contained",onClick:function(){return e.updateCurrentPosts(t)}},t):"..."===t?s.a.createElement(L.a,{className:"pageButton",key:a,num:t,variant:"contained",onClick:function(){return e.changePageChild.current.handleOpen()}},t):s.a.createElement(L.a,{className:"pageButton",key:a,num:t,variant:"contained",onClick:function(){return e.updateCurrentPosts(t)}},t)})))}}]),t}(s.a.Component),J=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleCreatePostOpen=function(){a.setState({createPost:!0,showPosts:!1})},a.handleCreatePostClose=function(){a.setState({createPost:!1,showPosts:!0})},a.logout=function(){a.props.logout(),a.handleCreatePostClose()},a.state={createPost:!1,showPosts:!0},a.helpChild=s.a.createRef(),a.handleCreatePostOpen=a.handleCreatePostOpen.bind(Object(R.a)(Object(R.a)(a))),a.handleCreatePostClose=a.handleCreatePostClose.bind(Object(R.a)(Object(R.a)(a))),a.logout=a.logout.bind(Object(R.a)(Object(R.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"ChangeView",value:function(e){Object(y.navigate)(e)}}]),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"content"},s.a.createElement("br",null),""===this.props.clickedUsername&&s.a.createElement(S.h,{container:!0,justify:"center",spacing:24},s.a.createElement(D,{ref:this.helpChild}),s.a.createElement(S.h,{item:!0,sm:7},!0===this.state.createPost&&s.a.createElement(H,{user:this.props.user,handleCreatePostClose:this.handleCreatePostClose}),!0===this.state.showPosts&&s.a.createElement(z,{updateClickedUsername:this.props.updateClickedUsername,clickedUsername:this.props.clickedUsername,updateClickedPost:this.props.updateClickedPost})),s.a.createElement(S.h,{item:!0,sm:3},s.a.createElement("br",null),s.a.createElement("fieldset",{className:"fieldset"},null==this.props.user&&s.a.createElement(S.h,{container:!0,justify:"center"},s.a.createElement(S.o,{variant:"h5",align:"center",gutterBottom:!0},"Welcome to Wise-Vizs!"),s.a.createElement("div",{className:"buttons"},s.a.createElement(S.j,null,s.a.createElement(S.a,{variant:"contained",color:"primary",className:"buttons",onClick:function(){e.ChangeView("/login")}},"Log in")),s.a.createElement(S.j,null,s.a.createElement(S.a,{variant:"contained",color:"secondary",className:"buttons",onClick:function(){e.ChangeView("/register")}},"Sign Up")))),null!=this.props.user&&s.a.createElement(S.h,{container:!0,justify:"center"},s.a.createElement("div",null,s.a.createElement(S.j,null,s.a.createElement(S.o,{variant:"h5",align:"center",gutterBottom:!0},"You're here, ",this.props.user.username,"!")),s.a.createElement(S.j,null,s.a.createElement(S.a,{variant:"contained",color:"primary",className:"buttons",onClick:function(){return e.handleCreatePostOpen()}},"Create Post")),s.a.createElement(S.j,null,s.a.createElement(S.a,{variant:"contained",color:"secondary",className:"buttons",onClick:function(){return e.logout()}},"Logout")))),s.a.createElement("p",{className:"help",align:"center",onClick:function(){return e.helpChild.current.handleOpen()}},"About Wise-Vizs")))),""!==this.props.clickedUsername&&s.a.createElement(S.h,{container:!0,justify:"center"},s.a.createElement(S.h,{item:!0,sm:8},s.a.createElement("h1",{className:"userPostTitle"},this.props.clickedUsername," 's posts"),s.a.createElement(z,{updateClickedUsername:this.props.updateClickedUsername,clickedUsername:this.props.clickedUsername,updateClickedPost:this.props.updateClickedPost}))))}}]),t}(s.a.Component);function W(e){return s.a.createElement(S.m,Object.assign({direction:"up"},e))}var G=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a.state={open:!1,errInfo:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(S.b,{open:this.state.open,TransitionComponent:W,onClose:this.handleClose},s.a.createElement(S.e,null,"Error information:"),s.a.createElement(S.d,null,s.a.createElement("br",null),s.a.createElement("b",null,this.props.errInfo)),s.a.createElement(S.c,null,s.a.createElement(S.a,{onClick:this.handleClose,color:"primary"},"Ok"))))}}]),t}(s.a.Component);function Y(e){return s.a.createElement(S.m,Object.assign({direction:"up"},e))}var Z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.ChangeView("/")},a.state={open:!1,errInfo:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"ChangeView",value:function(e){Object(y.navigate)(e)}}]),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(S.b,{open:this.state.open,TransitionComponent:Y,onClose:this.handleClose},s.a.createElement(S.d,null,s.a.createElement("br",null),s.a.createElement("b",null,"Congratulation! You have your own account. Please go to login page to login ^_^!")),s.a.createElement(S.c,null,s.a.createElement(S.a,{onClick:this.handleClose,color:"primary"},"Ok"))))}}]),t}(s.a.Component),$=a(27),K=a.n($),Q=a(30),X=a.n(Q),ee=a(29),te=a.n(ee),ae=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleEventChange=function(e){return function(t){var n=a.state.newUserData;n[e]=t.target.value,a.setState({newUserData:n})}},a.handleClickShowPassword=function(){a.setState({showPassword:!a.state.showPassword})},a.state={newUserData:{userName:"",email:"",password:"",confirmPassword:"",erroInfo:""},items:[],showPassword:!1},a.addNewAccount=a.addNewAccount.bind(Object(R.a)(Object(R.a)(a))),a.checkUserInfoAndAdd=a.checkUserInfoAndAdd.bind(Object(R.a)(Object(R.a)(a))),a.existUsername=a.existUsername.bind(Object(R.a)(Object(R.a)(a))),a.existEmail=a.existEmail.bind(Object(R.a)(Object(R.a)(a))),a.invalidNewUserErrorChild=s.a.createRef(),a.registerSucceedChild=s.a.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"ChangeView",value:function(e){Object(y.navigate)(e)}}]),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"checkUserInfoAndAdd",value:function(){var e=this,t={userName:this.state.newUserData.userName,email:this.state.newUserData.email},a=new Request("api/user-info/check-username-email-unique",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)});fetch(a).then(function(e){return e.json()}).then(function(t){return e.setState({items:t})}).then(function(t){var a={userID:Math.random().toString(36).substr(2,9),userName:e.state.newUserData.userName,password:e.state.newUserData.password,email:e.state.newUserData.email},n=e.state.newUserData.confirmPassword;if(n!==a.password||e.existUsername(a.userName)||e.existEmail(a.email)){var s="";""===a.userName?s="Username cannot be empty!":e.existUsername(a.userName)?s="The username is registered by the other person!":e.existEmail(a.email)?s="The email is used by the other person!":a.password!==a.confirmPassword&&(s="The password and the reentered Password are different!"),e.setState({newUserData:{userName:a.userName,password:a.password,confirmPassword:n,email:a.email,erroInfo:s}}),e.invalidNewUserErrorChild.current.handleOpen(),e.setState({newUserData:{userName:"",password:"",confirmPassword:"",email:"",erroInfo:e.state.newUserData.erroInfo}})}else{var r=new Request("api/user-info/post",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(a)});fetch(r).then(function(e){e.json().then(function(e){})}),e.registerSucceedChild.current.handleOpen()}}).catch(function(e){return console.log(e)})}},{key:"existUsername",value:function(e){var t=!1;for(var a in this.state.items){this.state.items[a].userName===e&&(t=!0)}return t}},{key:"existEmail",value:function(e){var t=!1;for(var a in this.state.items){this.state.items[a].email===e&&(t=!0)}return t}},{key:"addNewAccount",value:function(e){e.preventDefault(),this.checkUserInfoAndAdd()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"newUser"},s.a.createElement("br",null),s.a.createElement(G,{ref:this.invalidNewUserErrorChild,errInfo:this.state.newUserData.erroInfo}),s.a.createElement(Z,{ref:this.registerSucceedChild}),s.a.createElement("h2",{className:"title",align:"center"},"New User"),s.a.createElement("br",null),s.a.createElement("form",{className:"eventForm",onSubmit:this.addNewAccount},s.a.createElement(S.n,{required:!0,label:"User Name",margin:"dense",className:"registerText",value:this.state.newUserData.userName,onChange:this.handleEventChange("userName"),InputLabelProps:{shrink:!0}}),s.a.createElement("br",null),s.a.createElement(S.n,{required:!0,label:"Email",margin:"dense",className:"registerText",type:"email",value:this.state.newUserData.email,onChange:this.handleEventChange("email"),InputLabelProps:{shrink:!0}}),s.a.createElement("br",null),s.a.createElement(S.n,{required:!0,label:"Password",type:this.state.showPassword?"text":"password",margin:"dense",className:"registerText",value:this.state.newUserData.password,onChange:this.handleEventChange("password"),InputLabelProps:{shrink:!0},InputProps:{endAdornment:s.a.createElement(K.a,{position:"end"},s.a.createElement(S.i,{edge:"end","aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword},this.state.showPassword?s.a.createElement(te.a,null):s.a.createElement(X.a,null)))}}),s.a.createElement("br",null),s.a.createElement(S.n,{required:!0,label:"Confirm Password",type:this.state.showPassword?"text":"password",margin:"dense",className:"registerText",value:this.state.newUserData.confirmPassword,onChange:this.handleEventChange("confirmPassword"),InputLabelProps:{shrink:!0},InputProps:{endAdornment:s.a.createElement(K.a,{position:"end"},s.a.createElement(S.i,{edge:"end","aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword},this.state.showPassword?s.a.createElement(te.a,null):s.a.createElement(X.a,null)))}}),s.a.createElement("br",null)," ",s.a.createElement("br",null),s.a.createElement(S.a,{variant:"contained",className:"buttons",type:"button",onClick:function(){return e.ChangeView("/")}},"Cancel"),s.a.createElement(S.a,{variant:"contained",className:"buttons",type:"submit",color:"primary"},"Register")))}}]),t}(s.a.Component),ne=a(67),se=a.n(ne);function re(e){return s.a.createElement(S.m,Object.assign({direction:"up"},e))}var oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleEventChange=function(){return function(e){a.setState({email:e.target.value,invalidEmail:!1})}},a.handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a.state={open:!1,email:"",invalidEmail:!1,item:[],sendEmainEnable:!1,currentState:"Send Email"},a.validateEmail=a.validateEmail.bind(Object(R.a)(Object(R.a)(a))),a.sendEmail=a.sendEmail.bind(Object(R.a)(Object(R.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(R.a)(Object(R.a)(a))),a.getUserInfo=a.getUserInfo.bind(Object(R.a)(Object(R.a)(a))),a.disableSendEmailBtn=a.disableSendEmailBtn.bind(Object(R.a)(Object(R.a)(a))),a.sixtySec=a.sixtySec.bind(Object(R.a)(Object(R.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"ChangeView",value:function(e){Object(y.navigate)(e)}}]),Object(l.a)(t,[{key:"validateEmail",value:function(e){return/^(([^<>()\]\\.,;:\s@"]+(\.[^<>()\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}},{key:"disableSendEmailBtn",value:function(){this.setState({sendEmainEnable:!0});this.sixtySec(30)}},{key:"sixtySec",value:function(e){e>0?(setTimeout(this.sixtySec,1e3,e-1),this.setState({currentState:"Resend Email ("+e+")"})):(this.setState({currentState:"Resend Email"}),this.setState({sendEmainEnable:!1}))}},{key:"getUserInfo",value:function(){var e=this,t={email:this.state.email},a=new Request("api/user-info/check-email",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)});fetch(a).then(function(e){return e.json()}).then(function(t){return e.setState({item:t})}).then(function(){return e.handleSubmit(e.state.email,e.state.item)}).catch(function(e){return console.log(e)})}},{key:"handleSubmit",value:function(e,t){var a="Hi, "+t[0].userName+"\n \nYour password: "+t[0].password+"\nHave a good day with Wise-Viz. ^_^\n \nBest, \n \nWise-Viz";this.disableSendEmailBtn(),se()({method:"POST",url:"send",data:{email:e,message:a}}).then(function(e){"success"===e.data.msg?alert("Message Sent."):"fail"===e.data.msg&&alert("Message failed to send.")})}},{key:"sendEmail",value:function(){var e=this.state.email,t=this.validateEmail(e);t?this.getUserInfo():this.setState({invalidEmail:!t})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(S.b,{open:this.state.open,TransitionComponent:re,onClose:this.handleClose},s.a.createElement(S.e,null,"Get Back Password"),s.a.createElement(S.d,null,s.a.createElement("br",null),s.a.createElement("p",null,"Please enter the user email to get back the password."),s.a.createElement("form",{className:"sendEmail"},s.a.createElement(S.n,{error:this.state.invalidEmail,label:this.state.invalidEmail?"The email is invalid!":"User Email",margin:"dense",className:"registerText",value:this.state.email,onChange:this.handleEventChange(),InputLabelProps:{shrink:!0}}),s.a.createElement(S.a,{onClick:function(){return e.sendEmail()},color:"primary",variant:"contained",disabled:this.state.sendEmainEnable},this.state.currentState))),s.a.createElement(S.c,null,s.a.createElement(S.a,{onClick:this.handleClose,color:"primary"},"Go Back"))))}}]),t}(s.a.Component),ie=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleEventChange=function(e){return function(t){var n=a.state.userData;n[e]=t.target.value,a.setState({newUserData:n})}},a.handleClickShowPassword=function(){a.setState({showPassword:!a.state.showPassword})},a.state={userData:{email:"",password:"",erroInfo:""},items:[],showPassword:!1},a.login=a.login.bind(Object(R.a)(Object(R.a)(a))),a.existEmailAndPasswordCorrect=a.existEmailAndPasswordCorrect.bind(Object(R.a)(Object(R.a)(a))),a.invalidNewUserErrorChild=s.a.createRef(),a.checkUserInfoAndLogin=a.checkUserInfoAndLogin.bind(Object(R.a)(Object(R.a)(a))),a.onSuccess=a.onSuccess.bind(Object(R.a)(Object(R.a)(a))),a.GetPasswordChild=s.a.createRef(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"ChangeView",value:function(e){Object(y.navigate)(e)}}]),Object(l.a)(t,[{key:"onSuccess",value:function(e,t,a,n){this.props.onSuccess(e,t,a,n),this.ChangeView("/")}},{key:"componentDidMount",value:function(){}},{key:"checkUserInfoAndLogin",value:function(){var e=this,t={email:this.state.userData.email},a=new Request("api/user-info/check-email",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)});fetch(a).then(function(e){return e.json()}).then(function(t){return e.setState({items:t})}).then(function(t){var a={email:e.state.userData.email,password:e.state.userData.password};if(e.existEmailAndPasswordCorrect(a.email,a.password))e.onSuccess(a.email,e.state.items[0].userName,e.state.items[0].password,e.state.items[0].url);else{var n="";n=""===a.userName?"Email cannot be empty!":"The email is not exist or the password is incorrect!",e.setState({userData:{email:a.email,password:a.password,erroInfo:n}}),e.invalidNewUserErrorChild.current.handleOpen(),e.setState({userData:{email:"",password:"",erroInfo:e.state.userData.erroInfo}})}}).catch(function(e){return console.log(e)})}},{key:"existEmailAndPasswordCorrect",value:function(e,t){var a=!1;for(var n in this.state.items){var s=this.state.items[n];s.email===e&&s.password===t&&(a=!0)}return a}},{key:"login",value:function(e){e.preventDefault(),this.checkUserInfoAndLogin()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"newUser"},s.a.createElement(G,{ref:this.invalidNewUserErrorChild,errInfo:this.state.userData.erroInfo}),s.a.createElement(oe,{ref:this.GetPasswordChild}),s.a.createElement("br",null),s.a.createElement("h2",{className:"title",align:"center"},"Log In"),s.a.createElement("br",null),s.a.createElement("form",{className:"eventForm",onSubmit:this.login},s.a.createElement(S.n,{required:!0,label:"User Email",margin:"dense",type:"email",className:"registerText",value:this.state.userData.email,onChange:this.handleEventChange("email"),InputLabelProps:{shrink:!0}}),s.a.createElement("br",null),s.a.createElement(S.n,{required:!0,label:"Password",type:this.state.showPassword?"text":"password",margin:"dense",className:"registerText",value:this.state.userData.password,onChange:this.handleEventChange("password"),InputLabelProps:{shrink:!0},InputProps:{endAdornment:s.a.createElement(K.a,{position:"end"},s.a.createElement(S.i,{edge:"end","aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword},this.state.showPassword?s.a.createElement(te.a,null):s.a.createElement(X.a,null)))}}),s.a.createElement("br",null)," ",s.a.createElement("br",null),s.a.createElement(S.a,{variant:"contained",className:"buttons",type:"button",onClick:function(){return e.ChangeView("/")}},"Cancel"),s.a.createElement(S.a,{variant:"contained",className:"buttons",type:"submit",color:"primary"},"Login"),s.a.createElement("br",null),s.a.createElement("p",{className:"forgetPassword",onClick:function(){return e.GetPasswordChild.current.handleOpen()}},"Forget password?"),s.a.createElement("p",{className:"forgetPassword",onClick:function(){return e.ChangeView("/register")}},"Sign Up")))}}]),t}(s.a.Component),le=a(99),ce=a.n(le),ue=a(155),me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleEventChange=function(e){return function(t){var n=a.state.userData;n[e]=t.target.value,a.setState({userData:n,error:!1,oldPasswordRequire:!1,usernameUnique:!0,passwordError:!1,confirmPasswordError:a.state.userData.newPassword!==a.state.userData.confirmPassword&&a.state.confirmPasswordError,newPasswordError:""===a.state.userData.newPassword&&""!==a.state.userData.oldPassword&&a.state.newPasswordError})}},a.handleEventChangeForPicture=function(){return function(e){a.setState({picture:e.target.files[0]})}},a.handleClickShowPassword=function(){a.setState({showPassword:!a.state.showPassword})},a.uploadPicture=Object(ue.a)(ce.a.mark(function e(){var t;return ce.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:""!==a.state.picture&&((t=new FormData).append("file",a.state.picture),t.append("pictureID",a.props.user.email),{headers:{"content-type":"multipart/form-data"}},se.a.post("api/picture-info/update",t).then(function(e){alert("The file is successfully uploaded")}).catch(function(e){}));case 1:case"end":return e.stop()}},e)})),a.state={userData:{username:"",oldPassword:"",newPassword:"",confirmPassword:""},item:[],showPassword:!1,usernameUnique:!0,passwordError:!1,newPasswordError:!1,confirmPasswordError:!1,oldPasswordRequire:!1,errorInfo:"The username is registered by the other person!",picture:""},a.updateUserInfo=a.updateUserInfo.bind(Object(R.a)(Object(R.a)(a))),a.existUsername=a.existUsername.bind(Object(R.a)(Object(R.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"ChangeView",value:function(e){Object(y.navigate)(e)}}]),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"updateUserInfo",value:function(){var e=this;if(this.state.userData.oldPassword!==this.props.user.password&&""!==this.state.userData.oldPassword)this.setState({passwordError:!0});else if(""===this.state.userData.oldPassword&&""!==this.state.userData.newPassword)this.setState({oldPasswordRequire:!0});else if(""!==this.state.userData.oldPassword&&""===this.state.userData.newPassword)this.setState({newPasswordError:!0});else if(this.state.userData.newPassword!==this.state.userData.confirmPassword)this.setState({confirmPasswordError:!0});else if(!this.state.passwordError&&!this.state.oldPasswordRequire&&!this.state.newPasswordError&&!this.state.confirmPasswordError){var t={userName:this.state.userData.username},a=new Request("api/user-info/check-username-email-unique",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)});fetch(a).then(function(e){return e.json()}).then(function(t){return e.setState({item:t})}).then(function(){var t={email:e.props.user.email,userName:""===e.state.userData.username?e.props.user.username:e.state.userData.username,password:""===e.state.userData.newPassword?e.props.user.password:e.state.userData.newPassword,pictureID:e.state.userData.pictureID};if(e.existUsername(t.userName))e.setState({usernameUnique:!1});else{e.uploadPicture();var a=new Request("api/user-info/update-user-info",{method:"PUT",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(t)});fetch(a).then(function(e){return e.json()}).then(function(){e.props.onSuccess(t.email,t.userName,t.password,e.props.user.url),e.ChangeView("/")})}}).catch(function(e){return console.log(e)})}}},{key:"existUsername",value:function(e){var t=!1;for(var a in this.state.item){var n=this.state.item[a];n.userName===e&&n.email!==this.props.user.email&&(t=!0)}return t}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"content"},s.a.createElement("fieldset",{className:"fieldset"},s.a.createElement("form",null,s.a.createElement("div",{className:"postContentLayout"},s.a.createElement("img",{className:"roundedCircleArticleImg",src:this.props.user.url?"http://res.cloudinary.com/cjyjimmy520/image/upload/w_1000,c_fill,ar_1:1,g_auto,r_max,bo_5px_solid_red,b_rgb:262c35/"+this.props.user.url+"/profile_picture/"+this.props.user.email+"/"+this.props.user.email+".jpg":U.a,alt:"user",onError:function(e){e.target.onerror=null,e.target.src=U.a}}),s.a.createElement("div",{className:"postProfile"},s.a.createElement("h2",null,this.props.user.email))),s.a.createElement("h2",null,"User Info"),s.a.createElement("hr",{className:"hr",width:"100%",color:"#7986cb",size:3}),s.a.createElement("h2",null,"Username (update username by typing new name below) :"),s.a.createElement(S.n,{error:!this.state.usernameUnique,label:""===this.state.userData.username?this.props.user.username:this.state.usernameUnique?"new username":this.state.errorInfo,value:this.state.userData.username,className:"postTitleText",onChange:this.handleEventChange("username")}),s.a.createElement("br",null),s.a.createElement("h2",null,"Change Password:"),s.a.createElement(S.n,{error:this.state.passwordError||this.state.oldPasswordRequire,label:this.state.passwordError?"Old password is incorrect!":"Old Password",value:this.state.userData.oldPassword,className:"postTitleText",onChange:this.handleEventChange("oldPassword"),type:this.state.showPassword?"text":"password",InputProps:{endAdornment:s.a.createElement(K.a,{position:"end"},s.a.createElement(S.i,{edge:"end","aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword},this.state.showPassword?s.a.createElement(te.a,null):s.a.createElement(X.a,null)))}}),s.a.createElement("br",null),s.a.createElement(S.n,{error:this.state.newPasswordError,label:this.state.newPasswordError?"Require new password":"New Password",value:this.state.userData.Password,className:"postTitleText",onChange:this.handleEventChange("newPassword"),type:this.state.showPassword?"text":"password",InputProps:{endAdornment:s.a.createElement(K.a,{position:"end"},s.a.createElement(S.i,{edge:"end","aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword},this.state.showPassword?s.a.createElement(te.a,null):s.a.createElement(X.a,null)))}}),s.a.createElement("br",null),s.a.createElement(S.n,{error:this.state.confirmPasswordError,label:this.state.confirmPasswordError?"New password and confirm password are different!":"Confirm Password",value:this.state.userData.confirmPassword,className:"postTitleText",onChange:this.handleEventChange("confirmPassword"),type:this.state.showPassword?"text":"password",InputProps:{endAdornment:s.a.createElement(K.a,{position:"end"},s.a.createElement(S.i,{edge:"end","aria-label":"Toggle password visibility",onClick:this.handleClickShowPassword},this.state.showPassword?s.a.createElement(te.a,null):s.a.createElement(X.a,null)))}}),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("h2",null,"Update profile picture :"),s.a.createElement("input",{type:"file",onChange:this.handleEventChangeForPicture(),accept:"image/png, image/jpeg, image/gif, image/jpg"}),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement(S.a,{variant:"contained",color:"secondary",className:"postButtons",type:"button",onClick:function(){return e.ChangeView("/")}},"Cancel"),s.a.createElement(S.a,{variant:"contained",color:"primary",className:"postButtons",onClick:function(){return e.updateUserInfo()}},"Update"))))}}]),t}(s.a.Component),de=(a(390),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={post:a.props.clickedPost},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s.a.createElement("div",{className:"content"},s.a.createElement("br",null),s.a.createElement("h2",{className:"title",align:"center"},this.state.post.title),s.a.createElement("p",{className:"nameAndTime"},this.state.post.username," | ",this.state.post.postTime),s.a.createElement("br",null),s.a.createElement("form",{className:"postContentForm"},s.a.createElement("p",{className:"detail"},this.state.post.content)))}}]),t}(s.a.Component)),he=a(22).RouterMixin,pe=q()({displayName:"RoutedApp",getInitialState:function(){return{loggedIn:this.props.loggedIn}},mixins:[he],routes:{"/":"home","/register":"register","/login":"login","/user":"user","/postContent":"postContent"},render:function(){return this.renderCurrentRoute()},home:function(){return s.a.createElement(J,{loggedIn:this.props.loggedIn,onSuccess:this.props.onSuccess,logout:this.props.logout,user:this.props.user,updateClickedUsername:this.props.updateClickedUsername,clickedUsername:this.props.clickedUsername,clickedPost:this.props.clickedPost,updateClickedPost:this.props.updateClickedPost})},register:function(){return s.a.createElement(ae,null)},login:function(){return s.a.createElement(ie,{loggedIn:this.props.loggedIn,onSuccess:this.props.onSuccess,user:this.props.user})},user:function(){return s.a.createElement(me,{logout:this.props.logout,user:this.props.user,onSuccess:this.props.onSuccess})},postContent:function(){return s.a.createElement(de,{clickedPost:this.props.clickedPost,updateClickedPost:this.props.updateClickedPost})},notFound:function(e){return s.a.createElement("div",{className:"not-found"},"Page Not Found: ",e)}}),fe=(a(391),function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(c.a)(this,Object(u.a)(t).call(this))).state={loggedIn:!1,user:"",clickedUsername:"",clickedPost:[]},e}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=sessionStorage.getItem("email")?{email:sessionStorage.getItem("email"),username:sessionStorage.getItem("username"),password:sessionStorage.getItem("password"),url:sessionStorage.getItem("url")}:null;this.setState({loggedIn:!!e,user:e})}},{key:"updateClickedUsername",value:function(e){this.setState({clickedUsername:e}),sessionStorage.setItem("clickedUsername",e)}},{key:"updateClickedPost",value:function(e){this.setState({clickedPost:e}),sessionStorage.setItem("clickedPost",e)}},{key:"onSuccess",value:function(e,t,a,n){this.setState({loggedIn:!0,user:{email:e,username:t,password:a,url:n}}),sessionStorage.setItem("email",e),sessionStorage.setItem("username",t),sessionStorage.setItem("password",a),sessionStorage.setItem("url",n)}},{key:"logout",value:function(){this.setState({loggedIn:!1,user:null}),sessionStorage.removeItem("email"),sessionStorage.removeItem("username"),sessionStorage.removeItem("password"),sessionStorage.removeItem("url")}},{key:"render",value:function(){return s.a.createElement("div",{className:"background"},s.a.createElement(x.MuiThemeProvider,{theme:A},s.a.createElement("div",null,s.a.createElement(T,{updateClickedUsername:this.updateClickedUsername.bind(this),user:this.state.user}),s.a.createElement(pe,{loggedIn:this.loggedIn,onSuccess:this.onSuccess.bind(this),logout:this.logout.bind(this),user:this.state.user,history:!0,clickedUsername:this.state.clickedUsername,updateClickedUsername:this.updateClickedUsername.bind(this),clickedPost:this.state.clickedPost,updateClickedPost:this.updateClickedPost.bind(this)}))))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},47:function(e,t,a){},98:function(e,t,a){}},[[223,1,2]]]);
//# sourceMappingURL=main.25c882cc.chunk.js.map